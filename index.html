<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>クロッキー</title>
  <link rel="stylesheet" href="./styles.css">
</head>

<body>
  <header class="topbar">
    <button class="btn icon" id="menuBtn" aria-label="メニュー" aria-expanded="false">≡</button>

    <!-- 準備中（タイマー停止中）の最低限：入力欄は置かない -->
    <div class="menu-area" id="menuArea">
      <button class="btn" id="pickBtn">画像を追加</button>
      <button class="btn" id="clearBtn">全クリア</button>
      <button class="btn" id="startBtn">開始</button>
    </div>

    <!-- クロッキー中も表示する最低限 -->
    <div class="min-area">
      <button class="btn primary playOnly" id="playBtn">再生</button>
      <button class="btn primary stopOnly" id="stopBtn">停止</button>
    </div>
  </header>

  <div class="backdrop" id="backdrop"></div>
  <aside class="drawer" id="drawer" aria-label="設定メニュー">
    <div class="group">
      <b style="margin-right:auto;">メニュー</b>
      <button class="btn" id="closeDrawer">閉じる</button>
    </div>

    <div class="group">
      <button class="btn" id="pickBtn2">画像を追加</button>
      <button class="btn" id="clearBtn2">全クリア</button>
      <div class="small">選択枚数：<b id="pickedCount">0</b></div>
    </div>

    <!-- ✅ 秒数・規定枚数はここ（ハンバーガー内）のみ -->
    <div class="group">
      <div class="row">
        <label>秒数</label>
        <input id="secInput2" type="number" min="5" max="600" step="5" value="60">
        <label>規定枚数</label>
        <input id="countInput2" type="number" min="1" max="9999" step="1" value="10">
        <button class="btn" id="applySettings">反映</button>
      </div>

      <div class="row">
        <label class="row">
          <!-- ✅ シャッフルはデフォルトON -->
          <input type="checkbox" id="shuffleChk" checked>
          シャッフル（OFF→ONで再シャッフル）
        </label>
      </div>

      <div class="small">※クロッキー中は「画像＋時間＋☰＋停止」だけ表示。</div>
    </div>

    <div class="group">
      <div class="row">
        <button class="btn" id="pickEndImgBtn">終了画像を選択</button>
        <span class="small mono" id="endImgName">未設定</span>
      </div>
      <div class="row">
        <button class="btn" id="pickEndAudioBtn">終了音声を選択</button>
        <span class="small mono" id="endAudioName">未設定</span>
      </div>
      <div class="small">※VOICEVOX等で生成した音声ファイル（wav/mp3等）を終了時に1回再生。</div>
    </div>

    <div class="group">
      <button class="btn primary" id="startBtn2">開始</button>
      <button class="btn" id="nextBtn">次へ</button>
      <button class="btn" id="prevBtn">前へ</button>
    </div>

    <div class="group">
      <div class="small">
        現在：<span class="mono" id="posLabel">-</span>
      </div>
    </div>
  </aside>

  <main class="app">
    <section class="stage" aria-label="表示エリア">
      <!-- ✅ 時間表示：画像の上、中央付近（画像には被せない） -->
      <div class="timeLine" aria-label="残り時間">
        <div class="timePill">
          <span class="muted">残り</span><strong id="timeNum">--</strong><span class="muted">秒</span>
          <span class="muted">・</span>
          <span class="muted">進捗</span><strong id="shownNum">--</strong>
          <span class="muted">/</span><span class="muted" id="targetNum">--</span>
        </div>
      </div>

      <div class="imgWrap">
        <p class="hint" id="hint">
          「画像を追加」で複数枚を用意してから「開始」。<br>
          画像→（時間切れ）→3秒カウント→次画像… を繰り返し、規定枚数で終了します。
        </p>

        <!-- ✅ 3秒カウントは画像にオーバーレイ -->
        <div class="countdownOverlay" id="countdownOverlay" aria-label="カウントダウン">
          <div class="countdownInner">
            <div class="label">次の画像まで</div>
            <div class="num" id="countdownNum">3</div>
          </div>
        </div>

        <img id="img" alt="画像" hidden>
      </div>
    </section>
  </main>

  <!-- file inputs -->
  <input id="fileInput" type="file" accept="image/*" multiple hidden />
  <input id="endImgInput" type="file" accept="image/*" hidden />
  <input id="endAudioInput" type="file" accept="audio/*" hidden />

  <script src="./app.js"></script>
</body>
</html>
